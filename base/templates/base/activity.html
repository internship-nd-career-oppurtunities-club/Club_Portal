{% extends 'main.html' %}

{% block content %}


    <div class="main-container">
        <div class="content-wrapper">
            <div class="page-top-bar">
                <button class="back-link" onclick="window.location.href='{% url 'activities' %}'"><i class="fa-solid fa-arrow-left"></i> Back to Activities</button>
                <!-- <div class="actions">
                    <button class="btn btn-outline"><i class="fa-regular fa-pen-to-square"></i> Edit</button>
                    <button class="btn btn-danger-outline" onclick="toggleModal()"><i class="fa-regular fa-trash-can"></i> Delete</button>
                </div> -->
            </div>

            <div class="event-header">
                <div class="badge-row">
                    {% if activity.status == 'Completed' %}
                    <span class="badge past">Past Event</span>
                    {% elif activity.status == 'Live' %}
                    <span class="badge past">Upcoming Event</span>
                    {% else %}
                    <span class="badge past">Ongoing Event</span>
                    {% endif %}
                    <span class="badge type">{{ activity.type }}</span>
                </div>

                <h1 class="event-title">{{ activity.title }}</h1>

                <div class="event-meta">
                    <div class="meta-item"><i class="fa-regular fa-calendar"></i> {{ activity.startdate }}</div>
                    <div class="meta-item"><i class="fa-regular fa-clock"></i> {{ fromtime }} - {{ endtime }}</div>
                    <div class="meta-item"><i class="fa-solid fa-location-dot"></i> {{ venue }}</div>
                </div>
            </div>

            <div class="event-grid">
                <div class="left-col">
                    <div class="hero-image">
                        <img src="{{ activity.banner.url }}" alt="{{ activity.title }}">

                        {% if activity.status == 'Completed'  %}
                        <div class="watermark"><span>Event Ended</span></div>
                        {% endif %}

                    </div>

                    <div class="card">
                        <h3 class="card-title">About this Event</h3>
                        <p class="text-body">{{ activity.description }}</p>
                    </div>

                    <div class="card">
                        <h3 class="card-title">Agenda & Rounds</h3>

                        {% for round in rounds %}                        
                        <div class="round-item open">
                            <button class="round-header" onclick="toggleRound(this)">
                                <div class="round-left">
                                    <div class="round-num">{{ round.number }}</div>
                                    <span class="round-title">{{ round.title }}</span>
                                </div>
                                <i class="fa-solid fa-chevron-right round-arrow"></i>
                            </button>
                            <div class="round-body">
                                <div class="round-meta">
                                    <div><span class="label-xs">Date</span><div class="val-box"><i class="fa-regular fa-calendar"></i>{{ round.date }}</div></div>
                                    <div><span class="label-xs">Time</span><div class="val-box"><i class="fa-regular fa-clock"></i> {{ round.time }}</div></div>
                                </div>
                                
                                <span class="label-xs">Description</span>
                                <p class="text-body" style="font-size: 0.9rem;">{{ round.description }}</p>

                                <!-- <div class="round-resources">
                                    <span class="label-xs">Round Materials</span>
                                    <div class="round-res-list">
                                        <a href="#" class="round-res-link">
                                            <i class="fa-solid fa-file-powerpoint" style="color: #f97316;"></i>
                                            <span>Pitch Deck Template.pptx</span>
                                        </a>
                                        <a href="#" class="round-res-link">
                                            <i class="fa-solid fa-file-code" style="color: #3b82f6;"></i>
                                            <span>API Documentation v1.0</span>
                                        </a>
                                    </div>
                                </div> -->
                            </div>
                        </div>  
                        {% empty %}
                        <p></p>
                        {% endfor %}                      

                    </div>

                    <div class="card">
                        <h3 class="card-title">Event Resources</h3>
                        <div class="resources-grid">
                            {% for resource in activityResources %}
                            <a href="{{ resource.resourcefile }}" class="res-card">
                                <!-- <div class="res-icon bg-pdf"><i class="fa-solid fa-file-pdf"></i></div> -->
                                <div class="res-info"><h4>{{ resource.name }}</h4><span>{{ resource.type }} â€¢ {{ resource.size }}</span></div>
                            </a>
                            {% empty %}
                            <p>No prerequisites or Resources for this Event</p>
                            {% endfor %}

                        </div>
                    </div>
                    {% if activity.status == 'Completed' %}
                    <!-- <div class="card">
                        <h3 class="card-title">Event Highlights</h3>
                        
                        <div class="gallery-grid">
                            <div class="gallery-img"><img src="https://picsum.photos/seed/race1/400/300" alt="Race 1"></div>
                            <div class="gallery-img"><img src="https://picsum.photos/seed/race2/400/300" alt="Race 2"></div>
                        </div>

                        <div class="outcome-box">
                            <h4 class="outcome-title">Outcome</h4>
                            <p class="outcome-text">"Great success with over 95% positive feedback. 30 projects were submitted and 3 startups were formed!"</p>
                        </div>
                    </div>                    

                    <div class="card">
                        <div class="reviews-head">
                            <div>
                                <h3 class="card-title" style="margin:0;">Reviews & Feedback</h3>
                                <span class="text-body" style="font-size:0.875rem;">What participants thought.</span>
                            </div>
                            <div style="text-align:right;">
                                <div class="score">4.8</div>
                                <div class="stars"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star-half-stroke"></i></div>
                            </div>
                        </div>

                        <div class="review-item">
                            <div class="reviewer">
                                <img src="https://picsum.photos/seed/mike/100/100" alt="Mike">
                                <div><h4>Mike Ross</h4><span>Aug 21, 2025</span></div>
                            </div>
                            <div class="stars" style="font-size:0.75rem; margin-bottom:0.5rem;"><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i><i class="fa-solid fa-star"></i></div>
                            <p class="text-body" style="margin:0;">Absolutely insane event! The speeds were incredible.</p>
                        </div>

                        <div style="background:#f8fafc; padding:1rem; border-radius:0.5rem; border:1px solid var(--border);">
                            <h4 style="margin:0 0 1rem 0; font-size:0.875rem;">Leave a Review</h4>
                            <div class="form-group">
                                <textarea class="input-box" style="width:100%; border-radius:0.375rem; border:1px solid var(--border); padding:0.5rem;" rows="2" placeholder="Share your experience..."></textarea>
                            </div>
                            <button class="btn btn-primary" style="font-size:0.75rem;">Submit Review</button>
                        </div>
                    </div> -->
                    {% endif %}

                </div>

                <div class="right-col">
                    
                    
                    {% if activity.status == 'Completed' %}
                    <div class="card sticky-sidebar" style="text-align:center;">
                        <div style="width:3rem; height:3rem; background:#f1f5f9; border-radius:50%; display:flex; align-items:center; justify-content:center; margin:0 auto 1rem; color:#94a3b8; font-size:1.25rem;">
                            <i class="fa-regular fa-calendar-xmark"></i>
                        </div>
                        <h3 class="card-title">Event Ended</h3>
                        <p class="text-body" style="font-size:0.875rem;">This event has already taken place. Check out the gallery to see what happened!</p>
                        <button class="btn btn-outline btn-block" onclick="window.location.href='{% url 'activities' %}'">Find Upcoming Events</button>
                    </div>
                    {% else %}
                    <div class="card sticky-sidebar">
                        <h3 class="card-title">Reserve Your Spot</h3>
                        <div class="reg-status"><i class="fa-solid fa-users"></i> {{ activity.participants.all.count }} people registered</div>
                        <form method="post", action="">
                            {% csrf_token %}
                            <!-- <div class="form-group">
                                <label>Full Name</label>
                                <div class="input-box"><i class="fa-regular fa-user"></i><input type="text" placeholder="Alex Rivera"></div>
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <div class="input-box"><i class="fa-regular fa-envelope"></i><input type="email" placeholder="alex@nexus.edu"></div>
                            </div>
                            <div class="form-group">
                                <label>Special Requests</label>
                                <div class="input-box"><textarea rows="2"></textarea></div>
                            </div> -->
                            {% if request.user not in activity.participants.all  %}
                            <button type="submit" class="btn btn-primary btn-block">Register Now</button>
                            {% else %}
                            <button type="button" class="btn btn-primary btn-block">Registered</button>
                            {% endif %}


                            <p style="font-size:0.75rem; text-align:center; color:#94a3b8; margin-top:0.5rem;">By registering, you agree to our code of conduct.</p>
                        </form>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div id="deleteModal" class="modal-backdrop">
        <div class="modal-box">
            <div class="icon-circle-red"><i class="fa-regular fa-trash-can"></i></div>
            <h3 style="margin-top:0">Delete Event?</h3>
            <p class="text-body">This action cannot be undone.</p>
            <div style="display:flex; gap:0.5rem; margin-top:1.5rem;">
                <button class="btn btn-outline btn-block" onclick="toggleModal()">Cancel</button>
                <button class="btn btn-primary btn-block" style="background:#dc2626; border:none;">Delete</button>
            </div>
        </div>
    </div>

    <script>
        function toggleRound(btn) {
            btn.parentElement.classList.toggle('open');
        }
        function toggleModal() {
            document.getElementById('deleteModal').classList.toggle('show');
        }
    </script>
</body>
</html>

{% endblock %}

